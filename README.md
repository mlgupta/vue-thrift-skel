# vue-thrift-skel
Aim of this repo is to create a skeleton code for a vue project that communicates with the backend using thrift.

Unfortunately, things does not work very well with thrift.

Thrift compiler version used is `0.21.0`.
Node version used is `22.14.0`.

Thrift generates files in various format for javascript (`js`, `node`, `es6`, `ts`).

They are generated using:
```console
$ thrift --gen js:<type> api.thrift
$ thrift --gen js:js api.thrift
```
The above generates files under `gen-js` folder in js format.

```console
$ thrift --gen js:node api.thrift
```
generates files under `gen-nodejs` for nodejs.

```console
$ thrift --gen js:node,es6 api.thrift
```
Generates files under `gen-nodejs`, but these files are not true es6. These files still contain commonjs style `.require` and `module.exports`.

None of these files worked as generated by thrift. I was able to make them work in two ways:

First, I generated nodejs files and fed them to claude.ai with a request to convert them in es6 format. I was able to use generated files with minor modifications. These files are under `src/gen-es6`.

Second, I generated files with `js:node,es6` files and manually modified them. These are under `gen-nodejs`.

Both of the above options are not satisfactory for production use.

Finally found out that ESM output module for thrift was recently [committed](https://github.com/apache/thrift/commit/21ed4a2f690fb8547593c64df376b97a877b1675) to its codebase. thrift binary generated by this codebase was able to generate ESM files, which I was able to use as is.

```console
$ thrift --gen js:node,esm api.thrift
```

Only issue remains now is that neither thrift library nor thrift generated artifacts throw low level network errors (for e.g. when thrift server is down, one gets`net::ERR_CONNECTION_REFUSED` but that erros is nevr thrown). I got around it by implementing a timeout logic.

`src/services/thriftClient.js` calls thrift client.